from api import decode_story_string as decoder
from buttons import create_inline_buttons
import regex as re


help_message = '–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤–ø–æ–ª–Ω–µ —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º —Ö–æ—Ç–µ–ª–æ—Å—å –≤—ã–≥–ª—è–¥–µ—Ç—å —É—Å–ø–µ—à–Ω—ã–º–∏. –ù–æ —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ, \
—Ç–æ —Å–¥–µ–ª–∞–Ω–æ. –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç—Ä—É–¥–∞–º–∏ –∞–≤—Ç–æ—Ä–æ–≤ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ, –±–µ–∑ –ø–æ—Ç–µ—Ä—å. –ò –Ω–µ –Ω–∞–¥–æ —Å —Å–æ–∂–∞–ª–µ–Ω–∏–µ–º –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞—Ç—å \
—Ç–æ, —á—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–æ –ø–æ–¥ –ø—Ä–∏–∫—Ä—ã—Ç–∏–µ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.\n\
–ú—ã –Ω–µ –Ω–µ—Å–µ–º –Ω–∏ –∫–∞–∫–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, –Ω–æ —É –Ω–∞—Å –Ω–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤ –ø–æ–ª—É—á–∏—Ç—å –µ–µ! –ò –Ω–∞ —ç—Ç–æ –µ—Å—Ç—å –ø—Ä–∏—á–∏–Ω–∞!\n\
–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–π–¥–∏—Ç–µ –Ω–∞—Å. –≠—Ç–æ –≤–∞—à –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —à–∞–Ω—Å. –ò–Ω–∞—á–µ –≤—Å–µ –ø—Ä–æ–ø–∞–ª–æ. –ó–¥–µ—Å—å –Ω–µ—Ç –Ω—É–∂–Ω—ã—Ö –ª—é–¥–µ–π, –Ω–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤...\n\
–í–æ–ø—Ä–æ—Å—ã, –∂–∞–ª–æ–±—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è —Ç—É—Ç: @mgrankin'


start_message = '–≠—Ç–æ—Ç Telegram –±–æ—Ç —É–º–µ–µ—Ç –Ω–µ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ, —Ç–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Å —Å–∞–π—Ç–∞ porfirevich.ru\n@koval_yaroslav and @mgrankin\n<a href="https://github.com/koval01/Porfirevich_Bot">GitHub koval01/Porfirevich_Bot</a>'
# –¢–µ–∫—Å—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π \n –∑–∞–ø—Ä–µ—â–µ–Ω–æ —É–±–∏—Ä–∞—Ç—å

rate_limit = '–ù–µ –º–æ–≥—É —Ç–∞–∫ –±—ã—Å—Ç—Ä–æ —Ä–∞–±–æ—Ç–∞—Ç—å.'

error_command = '–ß—Ç–æ-—á—Ç–æ? –Ø —Ç–µ–±—è –Ω–µ –ø–æ–Ω—è–ª...'

info_text = '–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–≤–æ—é –∏—Å—Ç–æ—Ä–∏—é, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –Ω–∞ —Å–∞–π—Ç –ü–æ—Ä—Ñ–∏—Ä—å–µ–≤–∏—á–∞.'

website_link = create_inline_buttons(
    {"text": "–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç", "url": "https://porfirevich.ru/"},
)

commands_main_menu = [
    'üé≤üé≤',
    '–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é –∑–∞–ø–∏—Å—å?',
]


async def foramatted_message(data):
    """–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    text = await decoder(data['content'])
    likes = data['likesCount']
    link = create_inline_buttons(
        {"text": "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Å–∞–π—Ç–µ", "url": f"https://porfirevich.ru/{data['id']}"},
        {"text": "–ü–æ–ª—É—á–∏—Ç—å —Ñ–æ—Ç–æ", "callback_data": "get_photo_button"},
    )
    if len(text) > 4000: text[:4000]+'...'
    result = f'{text}\n{likes}‚ù§Ô∏è'
    return result, link


async def fix_string(string):
    """–£–¥–∞–ª–µ–Ω–∏—è –ª–∏—à–Ω–∏—Ö –æ—Ç—Å—Ç—É–ø–æ–≤"""
    out_string = re.findall(r'\w[-]\s\w', string)
    for i in out_string:
        a=i[:1];b=i[3:4];string = string.replace(i, a+'-'+b)
    symbl = ['¬´', '(', '[', '{', '"', '\'', '‚Äú']
    for i in symbl:
        string = string.replace(f' {i} ', f' {i}')
    return string